# HPC-MultiGPU-MatrixMult

## Running on [IBiSco](https://ibiscohpc-wiki.scope.unina.it/)

From the project's root directory, prepare and launch the jobs:

```bash
./scripts/run.sh
```

## Running Locally

### Requirements
- Python3
- NVIDIA GPU
- CUDA Toolkit
- OpenMPI
- NVIDIA Nsight Systems (optional, for profiling)

Install the required Python packages:
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

Compile and run the code:

```bash
mkdir -p csv profiling bin
nvcc -I/usr/local/openmpi/include -L/usr/local/openmpi/lib -lmpi -lcublas -lm -arch=sm_89 src/main.cu src/utils.cu src/phpc_matrix_operations.cu -o bin/a.out
mpirun -np <n_process> bin/a.out <matrix_size> <tile_width> <grid_width> <grid_height> <test_name>
```

> Your gpu architecture may differ. Adjust the `-arch=sm_89` flag accordingly.
> 
> Your system could have installed OpenMPI in a different location. Adjust the `-I` and `-L` flags accordingly.

Generate the plots:
```bash
python3 scripts/plot.py
```

## Outputs on IBiSco

Log files will be created in the `logs/` directory:
-   Standard output: `logs/output.log`
-   Errors: `logs/error.log`

Plots files will be generated in the `plots/` directory.

Profiling files generated by NVIDIA Nsight Systems will be saved in the `profiling/` directory:
-   1 file for each MPI process

## Outputs Locally

Standard output

Plots will be generated in the `plots/` directory.