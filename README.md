# HPC-MultiGPU-MatrixMult

## Running on a Cluster with SLURM

From the project's root directory, prepare and launch the jobs:

```bash
./scripts/run.sh
```

## Running Locally

> Your gpu architecture may differ. Adjust the `-arch=sm_89` flag accordingly. For example, use `-arch=sm_80` for Ampere GPUs.
> 
> Your system could have installed OpenMPI in a different location. Adjust the `-I` and `-L` flags accordingly.

```bash
mkdir -p logs csv profiling bin
nvcc -I/usr/local/openmpi/include -L/usr/local/openmpi/lib -lmpi -lcublas -lm -arch=sm_89 src/main.cu src/utils.cu src/phpc_matrix_operations.cu -o bin/a.out
mpirun -np <n_process> bin/a.out <matrix_size>
```

Log files will be created in the `logs/` directory:
-   Standard output: `logs/output.log`
-   Errors: `logs/error.log`

CSV files will be generated in the `csv/` directory.

Profiling files generated by NVIDIA Nsight Systems will be saved in the `profiling/` directory:
-   1 file for each MPI process